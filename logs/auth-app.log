2025-11-12T10:23:47.517+01:00  INFO 3080 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Starting LegendaryApplication using Java 17.0.12 with PID 3080 (C:\ALL_CODES\legendaryUserSpring\target\classes started by Owner in C:\ALL_CODES\legendaryUserSpring)
2025-11-12T10:23:47.550+01:00 DEBUG 3080 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Running with Spring Boot v3.5.6, Spring v6.2.11
2025-11-12T10:23:47.553+01:00  INFO 3080 --- [legendary] [main] c.l.legendary.LegendaryApplication       : No active profile set, falling back to 1 default profile: "default"
2025-11-12T10:23:50.687+01:00  INFO 3080 --- [legendary] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-12T10:23:50.884+01:00  INFO 3080 --- [legendary] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 178 ms. Found 3 JPA repository interfaces.
2025-11-12T10:23:52.895+01:00  INFO 3080 --- [legendary] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-11-12T10:23:52.922+01:00  INFO 3080 --- [legendary] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-12T10:23:52.923+01:00  INFO 3080 --- [legendary] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-11-12T10:23:53.048+01:00  INFO 3080 --- [legendary] [main] o.a.c.c.C.[Tomcat].[localhost].[/api]    : Initializing Spring embedded WebApplicationContext
2025-11-12T10:23:53.050+01:00  INFO 3080 --- [legendary] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 5352 ms
2025-11-12T10:23:53.618+01:00  INFO 3080 --- [legendary] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-12T10:23:53.836+01:00  INFO 3080 --- [legendary] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-11-12T10:23:53.937+01:00  INFO 3080 --- [legendary] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-11-12T10:23:54.624+01:00  INFO 3080 --- [legendary] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-12T10:23:54.760+01:00  INFO 3080 --- [legendary] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-12T10:23:55.230+01:00  INFO 3080 --- [legendary] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@45d38165
2025-11-12T10:23:55.236+01:00  INFO 3080 --- [legendary] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-12T10:23:55.519+01:00  WARN 3080 --- [legendary] [main] org.hibernate.orm.deprecation            : HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-12T10:23:55.600+01:00  INFO 3080 --- [legendary] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 9.0.1
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-12T10:23:58.666+01:00  INFO 3080 --- [legendary] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-12T10:23:59.670+01:00  INFO 3080 --- [legendary] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-12T10:24:00.399+01:00  INFO 3080 --- [legendary] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-12T10:24:01.696+01:00 DEBUG 3080 --- [legendary] [main] c.l.legendary.security.AuthTokenFilter   : Filter 'authTokenFilter' configured for use
2025-11-12T10:24:01.698+01:00 DEBUG 3080 --- [legendary] [main] o.s.w.f.ServerHttpObservationFilter      : Filter 'webMvcObservationFilter' configured for use
2025-11-12T10:24:01.698+01:00 DEBUG 3080 --- [legendary] [main] c.l.legendary.security.AuthTokenFilter   : Filter 'authenticationJwtTokenFilter' configured for use
2025-11-12T10:24:02.219+01:00  INFO 3080 --- [legendary] [main] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-12T10:24:02.221+01:00  WARN 3080 --- [legendary] [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-12T10:24:02.601+01:00  WARN 3080 --- [legendary] [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-12T10:24:02.949+01:00 DEBUG 3080 --- [legendary] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 17 mappings in 'requestMappingHandlerMapping'
2025-11-12T10:24:03.166+01:00 DEBUG 3080 --- [legendary] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-12T10:24:03.297+01:00  INFO 3080 --- [legendary] [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint beneath base path '/actuator'
2025-11-12T10:24:03.424+01:00 DEBUG 3080 --- [legendary] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, AuthTokenFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-11-12T10:24:03.575+01:00 DEBUG 3080 --- [legendary] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-12T10:24:03.696+01:00 DEBUG 3080 --- [legendary] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-12T10:24:04.218+01:00  INFO 3080 --- [legendary] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/api'
2025-11-12T10:24:04.249+01:00  INFO 3080 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Started LegendaryApplication in 18.104 seconds (process running for 18.965)
2025-11-12T10:24:04.437+01:00  INFO 3080 --- [legendary] [scheduling-1] c.l.legendary.service.AuthService        : Cleaned up expired tokens
2025-11-12T10:24:04.447+01:00  INFO 3080 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled token cleanup completed successfully
2025-11-12T10:24:04.451+01:00  INFO 3080 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled rate limit cache cleanup completed successfully
2025-11-12T10:25:29.465+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/api]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-12T10:25:29.465+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-12T10:25:29.465+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2025-11-12T10:25:29.473+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2025-11-12T10:25:29.474+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2025-11-12T10:25:29.477+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@41862a32
2025-11-12T10:25:29.479+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@56c75b4f
2025-11-12T10:25:29.479+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-12T10:25:29.479+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 14 ms
2025-11-12T10:25:29.543+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.security.web.FilterChainProxy        : Securing POST /auth/register
2025-11-12T10:25:29.597+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T10:25:29.621+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.security.web.FilterChainProxy        : Secured POST /auth/register
2025-11-12T10:25:29.629+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/register", parameters={}
2025-11-12T10:25:29.645+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#registerUser(RegisterRequest, HttpServletRequest)
2025-11-12T10:25:29.970+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [RegisterRequest(email=samuelkunle.sk@gmail.com, password=mySecurePassword123!, firstName=Samuel, las (truncated)...]
2025-11-12T10:25:30.117+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.controller.AuthController  : Received registration request for: samuelkunle.sk@gmail.com
2025-11-12T10:25:30.117+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.controller.AuthController  : Client IP: 0:0:0:0:0:0:0:1
2025-11-12T10:25:30.125+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Starting registration for email: samuelkunle.sk@gmail.com, IP: 0:0:0:0:0:0:0:1
2025-11-12T10:25:31.631+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : User saved to database: samuelkunle.sk@gmail.com
2025-11-12T10:25:31.647+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Verification token created for user: samuelkunle.sk@gmail.com
2025-11-12T10:25:38.873+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.EmailService       : Email sent successfully to: samuelkunle.sk@gmail.com
2025-11-12T10:25:38.873+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Verification email sent to: samuelkunle.sk@gmail.com
2025-11-12T10:25:38.873+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Registration completed successfully for: samuelkunle.sk@gmail.com
2025-11-12T10:25:38.905+01:00  INFO 3080 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.controller.AuthController  : Registration request processed successfully for: samuelkunle.sk@gmail.com
2025-11-12T10:25:38.938+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T10:25:38.946+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{success=true, message=Registration successful! Please check your email for verification instruction (truncated)...]
2025-11-12T10:25:38.986+01:00 DEBUG 3080 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T10:32:16.058+01:00  INFO 3080 --- [legendary] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-11-12T10:32:16.454+01:00  INFO 3080 --- [legendary] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-11-12T10:32:16.466+01:00  INFO 3080 --- [legendary] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-12T10:32:16.479+01:00  INFO 3080 --- [legendary] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-12T10:32:16.497+01:00  INFO 3080 --- [legendary] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-11-12T10:32:30.739+01:00  INFO 9656 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Starting LegendaryApplication using Java 17.0.12 with PID 9656 (C:\ALL_CODES\legendaryUserSpring\target\classes started by Owner in C:\ALL_CODES\legendaryUserSpring)
2025-11-12T10:32:30.754+01:00 DEBUG 9656 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Running with Spring Boot v3.5.6, Spring v6.2.11
2025-11-12T10:32:30.759+01:00  INFO 9656 --- [legendary] [main] c.l.legendary.LegendaryApplication       : No active profile set, falling back to 1 default profile: "default"
2025-11-12T10:32:34.173+01:00  INFO 9656 --- [legendary] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-12T10:32:34.385+01:00  INFO 9656 --- [legendary] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 172 ms. Found 3 JPA repository interfaces.
2025-11-12T10:32:36.203+01:00  INFO 9656 --- [legendary] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-11-12T10:32:36.225+01:00  INFO 9656 --- [legendary] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-12T10:32:36.226+01:00  INFO 9656 --- [legendary] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-11-12T10:32:36.327+01:00  INFO 9656 --- [legendary] [main] o.a.c.c.C.[Tomcat].[localhost].[/api]    : Initializing Spring embedded WebApplicationContext
2025-11-12T10:32:36.327+01:00  INFO 9656 --- [legendary] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 5357 ms
2025-11-12T10:32:36.863+01:00  INFO 9656 --- [legendary] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-12T10:32:36.960+01:00  INFO 9656 --- [legendary] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-11-12T10:32:37.025+01:00  INFO 9656 --- [legendary] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-11-12T10:32:37.625+01:00  INFO 9656 --- [legendary] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-12T10:32:37.689+01:00  INFO 9656 --- [legendary] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-12T10:32:38.004+01:00  INFO 9656 --- [legendary] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@27dc81be
2025-11-12T10:32:38.007+01:00  INFO 9656 --- [legendary] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-12T10:32:38.137+01:00  WARN 9656 --- [legendary] [main] org.hibernate.orm.deprecation            : HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-12T10:32:38.210+01:00  INFO 9656 --- [legendary] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 9.0.1
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-12T10:32:40.865+01:00  INFO 9656 --- [legendary] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-12T10:32:41.597+01:00  INFO 9656 --- [legendary] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-12T10:32:42.099+01:00  INFO 9656 --- [legendary] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-12T10:32:43.601+01:00 DEBUG 9656 --- [legendary] [main] c.l.legendary.security.AuthTokenFilter   : Filter 'authTokenFilter' configured for use
2025-11-12T10:32:43.607+01:00 DEBUG 9656 --- [legendary] [main] o.s.w.f.ServerHttpObservationFilter      : Filter 'webMvcObservationFilter' configured for use
2025-11-12T10:32:43.608+01:00 DEBUG 9656 --- [legendary] [main] c.l.legendary.security.AuthTokenFilter   : Filter 'authenticationJwtTokenFilter' configured for use
2025-11-12T10:32:44.087+01:00  INFO 9656 --- [legendary] [main] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-12T10:32:44.089+01:00  WARN 9656 --- [legendary] [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-12T10:32:44.489+01:00  WARN 9656 --- [legendary] [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-12T10:32:44.902+01:00 DEBUG 9656 --- [legendary] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 17 mappings in 'requestMappingHandlerMapping'
2025-11-12T10:32:45.140+01:00 DEBUG 9656 --- [legendary] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-12T10:32:45.253+01:00  INFO 9656 --- [legendary] [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint beneath base path '/actuator'
2025-11-12T10:32:45.374+01:00 DEBUG 9656 --- [legendary] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, AuthTokenFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-11-12T10:32:45.552+01:00 DEBUG 9656 --- [legendary] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-12T10:32:45.707+01:00 DEBUG 9656 --- [legendary] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-12T10:32:46.344+01:00  INFO 9656 --- [legendary] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/api'
2025-11-12T10:32:46.394+01:00  INFO 9656 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Started LegendaryApplication in 16.884 seconds (process running for 17.651)
2025-11-12T10:32:46.619+01:00  INFO 9656 --- [legendary] [scheduling-1] c.l.legendary.service.AuthService        : Cleaned up expired tokens
2025-11-12T10:32:46.624+01:00  INFO 9656 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled token cleanup completed successfully
2025-11-12T10:32:46.627+01:00  INFO 9656 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled rate limit cache cleanup completed successfully
2025-11-12T10:32:54.143+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/api]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-12T10:32:54.143+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-12T10:32:54.144+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2025-11-12T10:32:54.144+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2025-11-12T10:32:54.144+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2025-11-12T10:32:54.146+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@46f03d6d
2025-11-12T10:32:54.146+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@731ccdfc
2025-11-12T10:32:54.147+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-12T10:32:54.147+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2025-11-12T10:32:54.179+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.security.web.FilterChainProxy        : Securing POST /auth/register
2025-11-12T10:32:54.207+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T10:32:54.221+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.security.web.FilterChainProxy        : Secured POST /auth/register
2025-11-12T10:32:54.226+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/register", parameters={}
2025-11-12T10:32:54.230+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#registerUser(RegisterRequest, HttpServletRequest)
2025-11-12T10:32:54.504+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [RegisterRequest(email=samuelkunle.sk@gmail.com, password=mySecurePassword123!, firstName=Samuel, las (truncated)...]
2025-11-12T10:32:54.618+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.controller.AuthController  : Received registration request for: samuelkunle.sk@gmail.com
2025-11-12T10:32:54.621+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.controller.AuthController  : Client IP: 0:0:0:0:0:0:0:1
2025-11-12T10:32:54.622+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Starting registration for email: samuelkunle.sk@gmail.com, IP: 0:0:0:0:0:0:0:1
2025-11-12T10:32:55.639+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : User saved to database: samuelkunle.sk@gmail.com
2025-11-12T10:32:55.643+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Verification token created for user: samuelkunle.sk@gmail.com
2025-11-12T10:33:04.445+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.EmailService       : Email sent successfully to: samuelkunle.sk@gmail.com
2025-11-12T10:33:04.445+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Verification email sent to: samuelkunle.sk@gmail.com
2025-11-12T10:33:04.445+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.service.AuthService        : Registration completed successfully for: samuelkunle.sk@gmail.com
2025-11-12T10:33:04.512+01:00  INFO 9656 --- [legendary] [http-nio-8081-exec-2] c.l.legendary.controller.AuthController  : Registration request processed successfully for: samuelkunle.sk@gmail.com
2025-11-12T10:33:04.578+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T10:33:04.586+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{success=true, message=Registration successful! Please check your email for verification instruction (truncated)...]
2025-11-12T10:33:04.676+01:00 DEBUG 9656 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:01:05.373+01:00  INFO 9656 --- [legendary] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-11-12T11:01:05.826+01:00  INFO 9656 --- [legendary] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-11-12T11:01:05.835+01:00  INFO 9656 --- [legendary] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-12T11:01:05.838+01:00  INFO 9656 --- [legendary] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-12T11:01:05.843+01:00  INFO 9656 --- [legendary] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-11-12T11:01:20.085+01:00  INFO 14620 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Starting LegendaryApplication using Java 17.0.12 with PID 14620 (C:\ALL_CODES\legendaryUserSpring\target\classes started by Owner in C:\ALL_CODES\legendaryUserSpring)
2025-11-12T11:01:20.089+01:00 DEBUG 14620 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Running with Spring Boot v3.5.6, Spring v6.2.11
2025-11-12T11:01:20.092+01:00  INFO 14620 --- [legendary] [main] c.l.legendary.LegendaryApplication       : No active profile set, falling back to 1 default profile: "default"
2025-11-12T11:01:23.197+01:00  INFO 14620 --- [legendary] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-12T11:01:23.441+01:00  INFO 14620 --- [legendary] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 207 ms. Found 3 JPA repository interfaces.
2025-11-12T11:01:24.950+01:00  INFO 14620 --- [legendary] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8081 (http)
2025-11-12T11:01:25.005+01:00  INFO 14620 --- [legendary] [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-12T11:01:25.006+01:00  INFO 14620 --- [legendary] [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.46]
2025-11-12T11:01:25.136+01:00  INFO 14620 --- [legendary] [main] o.a.c.c.C.[Tomcat].[localhost].[/api]    : Initializing Spring embedded WebApplicationContext
2025-11-12T11:01:25.137+01:00  INFO 14620 --- [legendary] [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4884 ms
2025-11-12T11:01:25.718+01:00  INFO 14620 --- [legendary] [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-12T11:01:25.837+01:00  INFO 14620 --- [legendary] [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.29.Final
2025-11-12T11:01:25.898+01:00  INFO 14620 --- [legendary] [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-11-12T11:01:26.433+01:00  INFO 14620 --- [legendary] [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-12T11:01:26.488+01:00  INFO 14620 --- [legendary] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-12T11:01:26.863+01:00  INFO 14620 --- [legendary] [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@627d35ff
2025-11-12T11:01:26.868+01:00  INFO 14620 --- [legendary] [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-12T11:01:26.993+01:00  WARN 14620 --- [legendary] [main] org.hibernate.orm.deprecation            : HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-12T11:01:27.029+01:00  INFO 14620 --- [legendary] [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 9.0.1
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-12T11:01:29.374+01:00  INFO 14620 --- [legendary] [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-12T11:01:30.270+01:00  INFO 14620 --- [legendary] [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-12T11:01:30.897+01:00  INFO 14620 --- [legendary] [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-12T11:01:32.498+01:00 DEBUG 14620 --- [legendary] [main] c.l.legendary.security.AuthTokenFilter   : Filter 'authTokenFilter' configured for use
2025-11-12T11:01:32.503+01:00 DEBUG 14620 --- [legendary] [main] o.s.w.f.ServerHttpObservationFilter      : Filter 'webMvcObservationFilter' configured for use
2025-11-12T11:01:32.504+01:00 DEBUG 14620 --- [legendary] [main] c.l.legendary.security.AuthTokenFilter   : Filter 'authenticationJwtTokenFilter' configured for use
2025-11-12T11:01:32.927+01:00  INFO 14620 --- [legendary] [main] eAuthenticationProviderManagerConfigurer : Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-12T11:01:32.928+01:00  WARN 14620 --- [legendary] [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-12T11:01:33.263+01:00  WARN 14620 --- [legendary] [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-12T11:01:33.584+01:00 DEBUG 14620 --- [legendary] [main] s.w.s.m.m.a.RequestMappingHandlerMapping : 17 mappings in 'requestMappingHandlerMapping'
2025-11-12T11:01:33.803+01:00 DEBUG 14620 --- [legendary] [main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-12T11:01:33.925+01:00  INFO 14620 --- [legendary] [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint beneath base path '/actuator'
2025-11-12T11:01:34.056+01:00 DEBUG 14620 --- [legendary] [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, CorsFilter, LogoutFilter, AuthTokenFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-11-12T11:01:34.176+01:00 DEBUG 14620 --- [legendary] [main] s.w.s.m.m.a.RequestMappingHandlerAdapter : ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-12T11:01:34.340+01:00 DEBUG 14620 --- [legendary] [main] .m.m.a.ExceptionHandlerExceptionResolver : ControllerAdvice beans: 1 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-12T11:01:34.928+01:00  INFO 14620 --- [legendary] [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8081 (http) with context path '/api'
2025-11-12T11:01:34.971+01:00  INFO 14620 --- [legendary] [main] c.l.legendary.LegendaryApplication       : Started LegendaryApplication in 16.102 seconds (process running for 16.865)
2025-11-12T11:01:35.212+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.legendary.service.AuthService        : Cleaned up expired tokens
2025-11-12T11:01:35.218+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled token cleanup completed successfully
2025-11-12T11:01:35.222+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled rate limit cache cleanup completed successfully
2025-11-12T11:03:19.239+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/api]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-12T11:03:19.239+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-12T11:03:19.240+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Detected StandardServletMultipartResolver
2025-11-12T11:03:19.240+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Detected AcceptHeaderLocaleResolver
2025-11-12T11:03:19.240+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Detected FixedThemeResolver
2025-11-12T11:03:19.242+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@596c6c3e
2025-11-12T11:03:19.243+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Detected org.springframework.web.servlet.support.SessionFlashMapManager@566c6b91
2025-11-12T11:03:19.243+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-12T11:03:19.243+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2025-11-12T11:03:19.290+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /auth/register
2025-11-12T11:03:19.322+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:03:19.345+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.security.web.FilterChainProxy        : Secured POST /auth/register
2025-11-12T11:03:19.349+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/register", parameters={}
2025-11-12T11:03:19.353+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#registerUser(RegisterRequest, HttpServletRequest)
2025-11-12T11:03:19.629+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [RegisterRequest(email=samuelkunle.sk@gmail.com, password=mySecurePassword123!, firstName=Samuel, las (truncated)...]
2025-11-12T11:03:19.701+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.controller.AuthController  : Received registration request for: samuelkunle.sk@gmail.com
2025-11-12T11:03:19.702+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.controller.AuthController  : Client IP: 0:0:0:0:0:0:0:1
2025-11-12T11:03:19.704+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.AuthService        : Starting registration for email: samuelkunle.sk@gmail.com, IP: 0:0:0:0:0:0:0:1
2025-11-12T11:03:20.627+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.AuthService        : User saved to database: samuelkunle.sk@gmail.com
2025-11-12T11:03:20.631+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.AuthService        : Verification token created for user: samuelkunle.sk@gmail.com
2025-11-12T11:03:28.564+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.EmailService       : Email sent successfully to: samuelkunle.sk@gmail.com
2025-11-12T11:03:28.571+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.AuthService        : Verification email sent to: samuelkunle.sk@gmail.com
2025-11-12T11:03:28.571+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.AuthService        : Registration completed successfully for: samuelkunle.sk@gmail.com
2025-11-12T11:03:28.611+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.controller.AuthController  : Registration request processed successfully for: samuelkunle.sk@gmail.com
2025-11-12T11:03:28.668+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T11:03:28.676+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{success=true, message=Registration successful! Please check your email for verification instruction (truncated)...]
2025-11-12T11:03:28.748+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:05:12.983+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.security.web.FilterChainProxy        : Securing GET /test/admin
2025-11-12T11:05:13.064+01:00 ERROR 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.security.JwtUtils          : JWT token is expired: JWT expired at 2025-11-11T15:44:12Z. Current time: 2025-11-12T10:05:13Z, a difference of 66061056 milliseconds.  Allowed clock skew: 0 milliseconds.
2025-11-12T11:05:13.064+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:05:13.080+01:00 ERROR 14620 --- [legendary] [http-nio-8081-exec-5] c.l.l.security.AuthEntryPointJwt         : Unauthorized error: Full authentication is required to access this resource
2025-11-12T11:06:56.679+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.security.web.FilterChainProxy        : Securing GET /auth/verify-email?token=3b3bc35c-69b0-487a-a554-14c21e18e196
2025-11-12T11:06:56.679+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:06:56.679+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.security.web.FilterChainProxy        : Secured GET /auth/verify-email?token=3b3bc35c-69b0-487a-a554-14c21e18e196
2025-11-12T11:06:56.686+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.web.servlet.DispatcherServlet        : GET "/api/auth/verify-email?token=3b3bc35c-69b0-487a-a554-14c21e18e196", parameters={masked}
2025-11-12T11:06:56.686+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#verifyEmail(String)
2025-11-12T11:06:56.702+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-7] c.l.legendary.controller.AuthController  : Received email verification request for token: 3b3bc35c-69b0-487a-a554-14c21e18e196
2025-11-12T11:06:56.708+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-7] c.l.legendary.service.AuthService        : Starting email verification for token: 3b3bc35c-69b0-487a-a554-14c21e18e196
2025-11-12T11:06:56.824+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-7] c.l.legendary.service.AuthService        : Email verified successfully for user: samuelkunle.sk@gmail.com
2025-11-12T11:06:56.881+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-7] c.l.legendary.controller.AuthController  : Email verification successful for token: 3b3bc35c-69b0-487a-a554-14c21e18e196
2025-11-12T11:06:56.881+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T11:06:56.881+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{success=true, message=Email verified successfully! You can now log in to your account., timestamp=1 (truncated)...]
2025-11-12T11:06:56.885+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-7] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:07:03.608+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.security.web.FilterChainProxy        : Securing POST /auth/request-otp?
2025-11-12T11:07:03.616+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:07:03.618+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.security.web.FilterChainProxy        : Secured POST /auth/request-otp?
2025-11-12T11:07:03.619+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/request-otp", parameters={}
2025-11-12T11:07:03.620+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#requestOtp(LoginRequest, HttpServletRequest)
2025-11-12T11:07:03.624+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [LoginRequest(email=samuelkunle.sk@gmail.com)]
2025-11-12T11:07:16.713+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-9] c.l.legendary.service.EmailService       : Email sent successfully to: samuelkunle.sk@gmail.com
2025-11-12T11:07:16.713+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-9] c.l.legendary.service.AuthService        : OTP sent to user: samuelkunle.sk@gmail.com
2025-11-12T11:07:16.731+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:07:16.731+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["OTP sent to your email address."]
2025-11-12T11:07:16.743+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:07:41.527+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.security.web.FilterChainProxy        : Securing POST /auth/verify-otp
2025-11-12T11:07:41.529+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:07:41.531+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.security.web.FilterChainProxy        : Secured POST /auth/verify-otp
2025-11-12T11:07:41.531+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/verify-otp", parameters={}
2025-11-12T11:07:41.531+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#verifyOtp(OtpVerificationRequest)
2025-11-12T11:07:41.534+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [OtpVerificationRequest(email=samuelkunle.sk@gmail.com, otp=478333)]
2025-11-12T11:07:41.635+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-10] c.l.legendary.service.AuthService        : User logged in successfully with OTP: samuelkunle.sk@gmail.com
2025-11-12T11:07:41.660+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T11:07:41.660+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [AuthResponse(token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJzYW11ZWxrdW5sZS5za0BnbWFpbC5jb20iLCJpYXQiOjE3NjI5 (truncated)...]
2025-11-12T11:07:41.668+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-10] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:08:04.752+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] o.s.security.web.FilterChainProxy        : Securing GET /test/admin
2025-11-12T11:08:04.798+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] o.s.security.web.FilterChainProxy        : Secured GET /test/admin
2025-11-12T11:08:04.826+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : GET "/api/test/admin", parameters={}
2025-11-12T11:08:04.831+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.TestController#adminAccess()
2025-11-12T11:08:04.831+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.adminAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:08:04.902+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.adminAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:08:04.905+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:08:04.905+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] m.m.a.RequestResponseBodyMethodProcessor : Writing ["Admin Content."]
2025-11-12T11:08:04.905+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-2] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:08:21.308+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.security.web.FilterChainProxy        : Securing GET /test/user
2025-11-12T11:08:21.327+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.security.web.FilterChainProxy        : Secured GET /test/user
2025-11-12T11:08:21.341+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : GET "/api/test/user", parameters={}
2025-11-12T11:08:21.341+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.TestController#userAccess()
2025-11-12T11:08:21.341+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.userAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:08:21.349+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] horizationManagerBeforeMethodInterceptor : Failed to authorize ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.userAccess(); target is of class [com.legendaryUser.legendary.controller.TestController] with authorization manager org.springframework.security.authorization.ObservationAuthorizationManager@69ae37f5 and result ExpressionAuthorizationDecision [granted=false, expressionAttribute=hasRole('USER')]
2025-11-12T11:08:21.349+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.legendaryUser.legendary.exception.GlobalExceptionHandler#handleGenericException(Exception)
2025-11-12T11:08:21.349+01:00 ERROR 14620 --- [legendary] [http-nio-8081-exec-1] c.l.l.exception.GlobalExceptionHandler   : Unexpected error: Access Denied

org.springframework.security.authorization.AuthorizationDeniedException: Access Denied
	at org.springframework.security.authorization.method.ThrowingMethodAuthorizationDeniedHandler.handleDeniedInvocation(ThrowingMethodAuthorizationDeniedHandler.java:38) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.PreAuthorizeAuthorizationManager.handleDeniedInvocation(PreAuthorizeAuthorizationManager.java:108) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.ObservationAuthorizationManager.handleDeniedInvocation(ObservationAuthorizationManager.java:117) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.handle(AuthorizationManagerBeforeMethodInterceptor.java:287) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:260) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:196) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44) ~[spring-security-config-6.5.5.jar:6.5.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.11.jar:6.2.11]
	at com.legendaryUser.legendary.controller.TestController$$SpringCGLIB$$0.userAccess(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at com.legendaryUser.legendary.security.AuthTokenFilter.doFilterInternal(AuthTokenFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:490) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:351) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:83) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:129) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at com.legendaryUser.legendary.security.AuthTokenFilter.doFilterInternal(AuthTokenFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:334) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:225) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319) ~[spring-security-config-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$4(HandlerMappingIntrospector.java:267) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240) ~[spring-security-config-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at java.base/java.lang.Thread.run(Thread.java:842) ~[na:na]

2025-11-12T11:08:21.373+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:08:21.373+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["An unexpected error occurred. Please try again later."]
2025-11-12T11:08:21.381+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.security.authorization.AuthorizationDeniedException: Access Denied]
2025-11-12T11:08:21.381+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 500 INTERNAL_SERVER_ERROR
2025-11-12T11:08:36.173+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /test/admin
2025-11-12T11:08:36.205+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /test/admin
2025-11-12T11:08:36.237+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/test/admin", parameters={}
2025-11-12T11:08:36.237+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.TestController#adminAccess()
2025-11-12T11:08:36.237+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.adminAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:08:36.237+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.adminAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:08:36.245+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:08:36.245+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing ["Admin Content."]
2025-11-12T11:08:36.245+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:09:14.099+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.security.web.FilterChainProxy        : Securing POST /auth/register
2025-11-12T11:09:14.099+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:09:14.099+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.security.web.FilterChainProxy        : Secured POST /auth/register
2025-11-12T11:09:14.099+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/register", parameters={}
2025-11-12T11:09:14.099+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#registerUser(RegisterRequest, HttpServletRequest)
2025-11-12T11:09:14.099+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [RegisterRequest(email=samuelkunle215@gmail.com, password=mySecurePassword123!, firstName=Samuel, las (truncated)...]
2025-11-12T11:09:14.107+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.controller.AuthController  : Received registration request for: samuelkunle215@gmail.com
2025-11-12T11:09:14.107+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.controller.AuthController  : Client IP: 0:0:0:0:0:0:0:1
2025-11-12T11:09:14.107+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.service.AuthService        : Starting registration for email: samuelkunle215@gmail.com, IP: 0:0:0:0:0:0:0:1
2025-11-12T11:09:14.772+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.service.AuthService        : User saved to database: samuelkunle215@gmail.com
2025-11-12T11:09:14.784+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.service.AuthService        : Verification token created for user: samuelkunle215@gmail.com
2025-11-12T11:09:20.929+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.service.EmailService       : Email sent successfully to: samuelkunle215@gmail.com
2025-11-12T11:09:20.929+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.service.AuthService        : Verification email sent to: samuelkunle215@gmail.com
2025-11-12T11:09:20.929+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.service.AuthService        : Registration completed successfully for: samuelkunle215@gmail.com
2025-11-12T11:09:20.958+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-5] c.l.legendary.controller.AuthController  : Registration request processed successfully for: samuelkunle215@gmail.com
2025-11-12T11:09:20.959+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T11:09:20.962+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{success=true, message=Registration successful! Please check your email for verification instruction (truncated)...]
2025-11-12T11:09:20.967+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-5] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:10:20.894+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.security.web.FilterChainProxy        : Securing GET /auth/verify-email?token=8ce12a1f-8a7b-4a29-859c-8f15af886170
2025-11-12T11:10:20.894+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:10:20.894+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.security.web.FilterChainProxy        : Secured GET /auth/verify-email?token=8ce12a1f-8a7b-4a29-859c-8f15af886170
2025-11-12T11:10:20.894+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.web.servlet.DispatcherServlet        : GET "/api/auth/verify-email?token=8ce12a1f-8a7b-4a29-859c-8f15af886170", parameters={masked}
2025-11-12T11:10:20.894+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#verifyEmail(String)
2025-11-12T11:10:20.900+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-6] c.l.legendary.controller.AuthController  : Received email verification request for token: 8ce12a1f-8a7b-4a29-859c-8f15af886170
2025-11-12T11:10:20.905+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-6] c.l.legendary.service.AuthService        : Starting email verification for token: 8ce12a1f-8a7b-4a29-859c-8f15af886170
2025-11-12T11:10:20.921+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-6] c.l.legendary.service.AuthService        : Email verified successfully for user: samuelkunle215@gmail.com
2025-11-12T11:10:20.940+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-6] c.l.legendary.controller.AuthController  : Email verification successful for token: 8ce12a1f-8a7b-4a29-859c-8f15af886170
2025-11-12T11:10:20.942+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T11:10:20.942+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [{success=true, message=Email verified successfully! You can now log in to your account., timestamp=1 (truncated)...]
2025-11-12T11:10:20.944+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-6] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:10:32.405+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.security.web.FilterChainProxy        : Securing POST /auth/request-otp?
2025-11-12T11:10:32.408+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:10:32.409+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.security.web.FilterChainProxy        : Secured POST /auth/request-otp?
2025-11-12T11:10:32.409+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/request-otp", parameters={}
2025-11-12T11:10:32.410+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#requestOtp(LoginRequest, HttpServletRequest)
2025-11-12T11:10:32.412+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [LoginRequest(email=samuelkunle215@gmail.com)]
2025-11-12T11:10:37.647+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-8] c.l.legendary.service.EmailService       : Email sent successfully to: samuelkunle215@gmail.com
2025-11-12T11:10:37.647+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-8] c.l.legendary.service.AuthService        : OTP sent to user: samuelkunle215@gmail.com
2025-11-12T11:10:37.656+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:10:37.656+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["OTP sent to your email address."]
2025-11-12T11:10:37.656+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-8] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:11:49.236+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.security.web.FilterChainProxy        : Securing POST /auth/verify-otp
2025-11-12T11:11:49.236+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:11:49.236+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.security.web.FilterChainProxy        : Secured POST /auth/verify-otp
2025-11-12T11:11:49.236+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/verify-otp", parameters={}
2025-11-12T11:11:49.236+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#verifyOtp(OtpVerificationRequest)
2025-11-12T11:11:49.252+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [OtpVerificationRequest(email=samuelkunle.sk@gmail.com, otp=757837)]
2025-11-12T11:11:49.301+01:00 ERROR 14620 --- [legendary] [http-nio-8081-exec-9] c.l.legendary.controller.AuthController  : OTP verification failed: Invalid or expired OTP
2025-11-12T11:11:49.301+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:11:49.301+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["Invalid or expired OTP"]
2025-11-12T11:11:49.301+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-9] o.s.web.servlet.DispatcherServlet        : Completed 400 BAD_REQUEST
2025-11-12T11:12:03.267+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.security.web.FilterChainProxy        : Securing POST /auth/verify-otp
2025-11-12T11:12:03.267+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : Set SecurityContextHolder to anonymous SecurityContext
2025-11-12T11:12:03.267+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.security.web.FilterChainProxy        : Secured POST /auth/verify-otp
2025-11-12T11:12:03.275+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : POST "/api/auth/verify-otp", parameters={}
2025-11-12T11:12:03.275+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.AuthController#verifyOtp(OtpVerificationRequest)
2025-11-12T11:12:03.275+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] m.m.a.RequestResponseBodyMethodProcessor : Read "application/json;charset=UTF-8" to [OtpVerificationRequest(email=samuelkunle215@gmail.com, otp=757837)]
2025-11-12T11:12:03.299+01:00  INFO 14620 --- [legendary] [http-nio-8081-exec-1] c.l.legendary.service.AuthService        : User logged in successfully with OTP: samuelkunle215@gmail.com
2025-11-12T11:12:03.309+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-12T11:12:03.309+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing [AuthResponse(token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJzYW11ZWxrdW5sZTIxNUBnbWFpbC5jb20iLCJpYXQiOjE3NjI5 (truncated)...]
2025-11-12T11:12:03.316+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-1] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T11:12:28.477+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] o.s.security.web.FilterChainProxy        : Securing GET /test/admin
2025-11-12T11:12:28.502+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] o.s.security.web.FilterChainProxy        : Secured GET /test/admin
2025-11-12T11:12:28.526+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] o.s.web.servlet.DispatcherServlet        : GET "/api/test/admin", parameters={}
2025-11-12T11:12:28.527+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.TestController#adminAccess()
2025-11-12T11:12:28.527+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.adminAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:12:28.527+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] horizationManagerBeforeMethodInterceptor : Failed to authorize ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.adminAccess(); target is of class [com.legendaryUser.legendary.controller.TestController] with authorization manager org.springframework.security.authorization.ObservationAuthorizationManager@69ae37f5 and result ExpressionAuthorizationDecision [granted=false, expressionAttribute=hasRole('ADMIN')]
2025-11-12T11:12:28.527+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] .m.m.a.ExceptionHandlerExceptionResolver : Using @ExceptionHandler com.legendaryUser.legendary.exception.GlobalExceptionHandler#handleGenericException(Exception)
2025-11-12T11:12:28.527+01:00 ERROR 14620 --- [legendary] [http-nio-8081-exec-3] c.l.l.exception.GlobalExceptionHandler   : Unexpected error: Access Denied

org.springframework.security.authorization.AuthorizationDeniedException: Access Denied
	at org.springframework.security.authorization.method.ThrowingMethodAuthorizationDeniedHandler.handleDeniedInvocation(ThrowingMethodAuthorizationDeniedHandler.java:38) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.PreAuthorizeAuthorizationManager.handleDeniedInvocation(PreAuthorizeAuthorizationManager.java:108) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.ObservationAuthorizationManager.handleDeniedInvocation(ObservationAuthorizationManager.java:117) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.handle(AuthorizationManagerBeforeMethodInterceptor.java:287) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:260) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:196) ~[spring-security-core-6.5.5.jar:6.5.5]
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44) ~[spring-security-config-6.5.5.jar:6.5.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.11.jar:6.2.11]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728) ~[spring-aop-6.2.11.jar:6.2.11]
	at com.legendaryUser.legendary.controller.TestController$$SpringCGLIB$$0.adminAccess(<generated>) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.46.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at com.legendaryUser.legendary.security.AuthTokenFilter.doFilterInternal(AuthTokenFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:490) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:351) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:83) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:129) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:125) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:119) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:131) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:85) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at com.legendaryUser.legendary.security.AuthTokenFilter.doFilterInternal(AuthTokenFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:241) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:334) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:225) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:138) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191) ~[spring-security-web-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:319) ~[spring-security-config-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$4(HandlerMappingIntrospector.java:267) ~[spring-webmvc-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:240) ~[spring-security-config-6.5.5.jar:6.5.5]
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.11.jar:6.2.11]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.11.jar:6.2.11]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1776) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:975) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:493) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.46.jar:10.1.46]
	at java.base/java.lang.Thread.run(Thread.java:842) ~[na:na]

2025-11-12T11:12:28.541+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:12:28.541+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] o.s.w.s.m.m.a.HttpEntityMethodProcessor  : Writing ["An unexpected error occurred. Please try again later."]
2025-11-12T11:12:28.541+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] .m.m.a.ExceptionHandlerExceptionResolver : Resolved [org.springframework.security.authorization.AuthorizationDeniedException: Access Denied]
2025-11-12T11:12:28.543+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-3] o.s.web.servlet.DispatcherServlet        : Completed 500 INTERNAL_SERVER_ERROR
2025-11-12T11:12:35.580+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.security.web.FilterChainProxy        : Securing GET /test/user
2025-11-12T11:12:35.610+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.security.web.FilterChainProxy        : Secured GET /test/user
2025-11-12T11:12:35.643+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.web.servlet.DispatcherServlet        : GET "/api/test/user", parameters={}
2025-11-12T11:12:35.643+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped to com.legendaryUser.legendary.controller.TestController#userAccess()
2025-11-12T11:12:35.643+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] horizationManagerBeforeMethodInterceptor : Authorizing method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.userAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:12:35.643+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] horizationManagerBeforeMethodInterceptor : Authorized method invocation ReflectiveMethodInvocation: public java.lang.String com.legendaryUser.legendary.controller.TestController.userAccess(); target is of class [com.legendaryUser.legendary.controller.TestController]
2025-11-12T11:12:35.643+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Using 'text/plain', given [*/*] and supported [text/plain, */*, application/json, application/*+json]
2025-11-12T11:12:35.643+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] m.m.a.RequestResponseBodyMethodProcessor : Writing ["User Content."]
2025-11-12T11:12:35.651+01:00 DEBUG 14620 --- [legendary] [http-nio-8081-exec-4] o.s.web.servlet.DispatcherServlet        : Completed 200 OK
2025-11-12T12:14:08.337+01:00  WARN 14620 --- [legendary] [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=36m10s864ms490s700ns).
2025-11-12T12:37:24.760+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.legendary.service.AuthService        : Cleaned up expired tokens
2025-11-12T12:37:24.775+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled token cleanup completed successfully
2025-11-12T13:01:34.937+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.legendary.service.AuthService        : Cleaned up expired tokens
2025-11-12T13:01:34.948+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled token cleanup completed successfully
2025-11-12T14:01:35.053+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.legendary.service.AuthService        : Cleaned up expired tokens
2025-11-12T14:01:35.053+01:00  INFO 14620 --- [legendary] [scheduling-1] c.l.l.scheduler.TokenCleanupScheduler    : Scheduled token cleanup completed successfully
2025-11-12T14:13:36.751+01:00  INFO 14620 --- [legendary] [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-11-12T14:13:36.995+01:00  INFO 14620 --- [legendary] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-11-12T14:13:37.101+01:00  INFO 14620 --- [legendary] [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-12T14:13:37.169+01:00  INFO 14620 --- [legendary] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-12T14:13:37.183+01:00  INFO 14620 --- [legendary] [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
